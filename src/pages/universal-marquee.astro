<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Universal Marquee</title>
    <style is:global data-label="CORE_STYLES">
      :root {
        --um-duration-default: 15s;
        --um-gap-default: 2rem;
        --um-color-separator: #9ca3af;
        --um-separator-height: 1.25em;
        --um-font-size: clamp(1.2rem, 3vw, 2rem);
        --um-gallery-item-width: 420px;
        --um-gallery-item-height: 280px;
        --um-gallery-border-radius: 24px;
      }
      .um-container {
        display: flex;
        overflow: hidden;
        user-select: none;
        width: 100%;
        min-width: 0;
        position: relative;
        transform: translate3d(0, 0, 0);
      }
      .um-container[role='region'] {
        outline: none;
      }
      .um-sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        border-width: 0;
      }
      .um-container .um-track {
        display: none;
      }
      .um-container.js-enabled .um-track {
        display: flex;
      }
      .um-track {
        align-items: center;
        flex-wrap: nowrap;
        gap: var(--um-gap);
        will-change: transform;
        backface-visibility: hidden;
        perspective: 1000px;
      }
      .um-track > div {
        display: flex;
        align-items: center;
        flex-wrap: nowrap;
        flex-shrink: 0;
        gap: var(--um-gap);
      }
      .um-track > div > * {
        flex-shrink: 0;
        white-space: nowrap;
        display: flex;
        align-items: center;
        font-size: var(--um-font-size);
        font-weight: 700;
        font-family:
          'Inter',
          'Segoe UI',
          system-ui,
          -apple-system,
          sans-serif;
      }
      .um-img-skeleton {
        position: relative;
        background-color: #e5e7eb;
        overflow: hidden;
        border-radius: var(--um-gallery-border-radius);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        transition:
          background-color 0.4s,
          box-shadow 0.5s;
        width: var(--um-gallery-item-width);
        height: var(--um-gallery-item-height);
        min-width: var(--um-gallery-item-width);
        min-height: var(--um-gallery-item-height);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .um-img-skeleton img {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
        opacity: 0;
        transition: opacity 0.7s ease-out;
      }
      .um-img-skeleton img.loaded {
        opacity: 1;
      }
      .um-img-skeleton.loaded {
        background-color: transparent;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
      }
      .um-item-separator .um-img-skeleton {
        background-color: transparent;
        box-shadow: none;
        height: var(--um-separator-height);
        width: auto;
        min-width: var(--um-separator-height);
        aspect-ratio: 1/1;
      }
      .um-container.um-overflow-left::before,
      .um-container.um-overflow-right::after {
        content: '';
        position: absolute;
        top: 0;
        bottom: 0;
        width: 120px;
        pointer-events: none;
        z-index: 2;
      }
      .um-container.um-overflow-left::before {
        left: 0;
        background: linear-gradient(to right, var(--bg), transparent);
      }
      .um-container.um-overflow-right::after {
        right: 0;
        background: linear-gradient(to left, var(--bg), transparent);
      }
      @media (prefers-reduced-motion: reduce) {
        .um-container {
          overflow-x: auto !important;
          -webkit-overflow-scrolling: touch;
        }
        .um-track {
          width: max-content !important;
          transform: none !important;
          animation: none !important;
          justify-content: flex-start;
        }
      }
    </style>
    <style is:global data-label="ROOT_LAYOUT">
      :root {
        --color-bg-page: #fff;
        --color-text-primary: #111827;
        --color-gridline: #eef1ee;
        --layout-max-width: 1200px;
        --layout-gutter: 1.25rem;
        --layout-guide-width: 1px;
        --layout-guide-style: dashed;
        --layout-vertical-padding: 4rem;
        --layout-footer-height: 4rem;
      }
      body {
        margin: 0;
        padding: 0;
        font-family:
          'Inter',
          'Segoe UI',
          system-ui,
          -apple-system,
          sans-serif;
        display: flex;
        background-color: var(--color-bg-page);
        color: var(--color-text-primary);
        min-height: 100vh;
      }
      .RootLayout {
        position: relative;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 0;
      }
      .RootLayout::before,
      .RootLayout::after {
        content: '';
        border-top: var(--layout-guide-width) var(--layout-guide-style) var(--color-gridline);
        height: 0;
        position: absolute;
        left: 0;
        right: 0;
        z-index: 1;
        opacity: 1;
      }
      .RootLayout::before {
        top: var(--layout-vertical-padding);
      }
      .RootLayout::after {
        bottom: var(--layout-vertical-padding);
        border-bottom: var(--layout-guide-width) var(--layout-guide-style) var(--color-gridline);
        border-top: none;
      }
      .RootLayoutContainer {
        width: calc(100% - (var(--layout-gutter) * 2));
        max-width: var(--layout-max-width);
        min-height: 100%;
        position: relative;
        margin-inline: auto;
        display: flex;
        flex-direction: column;
        padding-top: var(--layout-vertical-padding);
        padding-bottom: var(--layout-vertical-padding);
        box-sizing: border-box;
      }
      .RootLayoutHeader,
      .RootLayoutFooter {
        position: absolute;
        right: 0;
        bottom: 0;
        left: 0;
        height: var(--layout-footer-height);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .RootLayoutHeader {
        top: 0;
      }
      .RootLayoutContent {
        display: flex;
        flex-direction: column;
        flex: 1;
      }
      .RootLayoutFooter {
        bottom: 0;
      }
      h2.demo-title {
        margin: 0 0 0.5rem 0;
        font-size: 1.1rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        text-align: center;
        color: #374151;
      }
      p.demo-desc {
        text-align: center;
        margin: 0 0 1rem 0;
        font-size: 0.85rem;
        color: #9ca3af;
      }
      @media (min-width: 64rem) {
        .RootLayout::before,
        .RootLayout::after {
          opacity: 1;
          background-color: transparent;
          height: 0;
        }
        .RootLayoutContainer {
          border-left: var(--layout-guide-width) var(--layout-guide-style) var(--color-gridline);
          border-right: var(--layout-guide-width) var(--layout-guide-style) var(--color-gridline);
        }
      }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@700;800;900&display=swap" rel="stylesheet" />
  </head>
  <body>
    <div class="RootLayout">
      <div class="RootLayoutContainer">
        <div class="RootLayoutHeader">
          <svg xmlns="http://www.w3.org/2000/svg" width="72" fill="none" viewBox="0 0 554 264">
            <path
              fill="#000"
              d="m136.657 5.657-125.5 125.5 126.5 126.5-5.657 5.656L0 131.314l.158-.158L.001 131 131 0l5.657 5.657Zm51 0-125.5 125.5 126.5 126.5-5.657 5.656L51 131.314l.158-.158-.157-.156L182 0l5.657 5.657ZM502.656 131l-.157.156.158.158-132 131.999-5.657-5.656 126.5-126.5L366 5.657 371.657 0l130.999 131Zm51 0-.157.156.158.158-132 131.999-5.657-5.656 126.5-126.5L417 5.657 422.657 0l130.999 131Zm-97.695.327-5.657 5.657-86.271-86.27-.068.068v160.889l.165.165 80.51-80.508 5.657 5.656-82.101 82.1.001.001-4.066 4.065-4.166-4.167v.001l-51-51 5.657-5.656 10.343 10.343v-44.068l-22.534 22.533.002.002-.082.081.033.033-19.005 19.004.002.002-6.367 6.366-26.193-26.192.001-.002-21.826-21.827v44.068l10.343-10.343 5.657 5.656-50.211 50.211.002.002-4.957 4.956-6.371-6.371.001-.002-79.796-79.796 5.657-5.656 80.51 80.508.165-.165V50.782l-.068-.068-86.271 86.27L98 131.327l91.67-91.67 87.31 87.311 87.311-87.31 91.67 91.669Zm-257.965 72.344 22-22v-74.8l9 9v.004l28.191 28.19.001-.001 19.795 19.796 13.047-13.048-13.467-13.467-.001.003-78.566-78.566v144.889Zm85.025-71.945 8.54 8.54v.002l4.503 4.503h.001l.002.001 28.898-28.897v-.004l9-9v74.8l22 22V58.782l-72.944 72.944Z"
            ></path>
          </svg>
        </div>
        <div class="RootLayoutContent">
          <main>
            <div
              id="marquee-demo-1"
              style="background: #111827; color: white; padding: 0.8rem 0; --um-gap: 3rem; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-2.68deg);"
            >
              <h2 class="demo-title"></h2>
            </div>
          </main>
        </div>
        <div class="RootLayoutFooter">
          <span>Copyright © Universal Marquee 2025 by Ledi Hildawan x AI</span>
        </div>
      </div>
    </div>
    <script type="module">
      class ContentBuilder {
        constructor(options) {
          this._opts = options;
        }
        #buildSeparatorNode(separator) {
          const container = document.createElement('span');
          container.classList.add('um-item-separator');
          container.setAttribute('aria-hidden', 'true');
          if (typeof separator === 'string') {
            container.textContent = separator;
          } else if (separator instanceof Node) {
            container.appendChild(separator.cloneNode(true));
          } else if (separator && separator.tagName === 'svg') {
            container.appendChild(separator.cloneNode(true));
          }
          container.querySelectorAll('*').forEach((el) => {
            if (el.id) el.removeAttribute('id');
            el.setAttribute('tabindex', '-1');
          });
          return container;
        }
        buildCycleContent(forSR = false, addTrailingSeparator = true) {
          const frag = document.createDocumentFragment();
          const items = this._opts.items;
          if (!items?.length) return frag;
          for (let i = 0; i < items.length; i++) {
            const item = items[i];
            if (forSR) {
              const li = document.createElement('li');
              li.textContent = item.alt || item;
              frag.appendChild(li);
            } else {
              let node = this._opts.renderItem(item);
              if (!(node instanceof Element)) {
                const wrapper = document.createElement('span');
                wrapper.appendChild(node);
                node = wrapper;
              }
              const cloned = node.cloneNode(true);
              const img = cloned.querySelector('img');
              if (img) {
                const markLoaded = () => {
                  img.classList.add('loaded');
                  cloned.classList.add('loaded');
                };
                img.onload = markLoaded;
                img.onerror = markLoaded;
                if (img.complete && img.naturalWidth > 0) markLoaded();
              }
              if (cloned.id) cloned.removeAttribute('id');
              cloned.querySelectorAll('*').forEach((el) => {
                if (el.id) el.removeAttribute('id');
                el.setAttribute('tabindex', '-1');
              });
              frag.appendChild(cloned);
              if (i < items.length - 1 || addTrailingSeparator) {
                const sep = this.#buildSeparatorNode(this._opts.separator);
                if (sep) frag.appendChild(sep);
              }
            }
          }
          return frag;
        }
        buildCycleContainer(addTrailingSeparator = true) {
          const div = document.createElement('div');
          div.appendChild(this.buildCycleContent(false, addTrailingSeparator));
          return div;
        }
        buildSRList() {
          const ul = document.createElement('ul');
          ul.className = 'um-sr-only';
          ul.appendChild(this.buildCycleContent(true));
          return ul;
        }
        measureCycleMetrics(root) {
          if (!this._opts.items?.length) return { width: 0, gap: 0 };
          const temp = document.createElement('div');
          temp.className = 'um-track';
          temp.style.position = 'absolute';
          temp.style.visibility = 'hidden';
          let gapVal = this._opts.gap;
          if (typeof gapVal === 'number') gapVal = `${gapVal}px`;
          temp.style.setProperty('--um-gap', gapVal);
          const cycle = this.buildCycleContainer(true);
          temp.appendChild(cycle);
          root.appendChild(temp);
          const width = cycle.offsetWidth || 0;
          const parsedGap = parseFloat(getComputedStyle(temp).gap || '0');
          root.removeChild(temp);
          return { width, gap: parsedGap };
        }
      }

      class AnimationController {
        constructor(track, opts) {
          this._track = track;
          this._opts = opts;
        }
        start(cycleWidth, gap) {
          if (this._anim) this._anim.cancel();
          if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
          const distance = cycleWidth + gap;
          if (distance <= 0) return;
          let duration = this._opts.duration
            ? this._opts.duration * 1000
            : (distance / (this._opts.speed > 0 ? this._opts.speed : 50)) * 1000;
          const from = 'translate3d(0,0,0)';
          const to = `translate3d(-${distance}px,0,0)`;
          const keyframes =
            this._opts.direction === 'right'
              ? [{ transform: to }, { transform: from }]
              : [{ transform: from }, { transform: to }];
          this._anim = this._track.animate(keyframes, {
            duration,
            iterations: Infinity,
            easing: 'linear',
          });
        }
        pause() {
          if (this._anim?.playState === 'running') this._anim.pause();
        }
        play() {
          if (this._anim?.playState !== 'running') this._anim.play();
        }
        cancel() {
          if (this._anim) this._anim.cancel();
        }
      }

      class UniversalMarquee {
        constructor(selector, opts) {
          this._root = document.querySelector(selector);
          if (!this._root) return;
          this._opts = {
            speed: 50,
            duration: null,
            gap: '2rem',
            direction: 'left',
            items: [],
            separator: '',
            renderItem: (i) => document.createTextNode(i),
            pauseOnHover: true,
            ariaLabel: 'List of items automatically moving in a marquee',
            ...opts,
          };
          this._root.classList.add('um-container', 'js-enabled');
          this._root.setAttribute('role', 'region');
          this._root.setAttribute('aria-label', this._opts.ariaLabel);
          this._root.style.setProperty('--bg', getComputedStyle(this._root).backgroundColor);
          this._builder = new ContentBuilder(this._opts);
          this.#setup();
          this.#initObservers();
          this.#initInteractivity();
        }
        #setup() {
          this._root.innerHTML = '';
          this._track = document.createElement('div');
          this._track.className = 'um-track';
          this._track.setAttribute('aria-hidden', 'true');
          if ('inert' in this._track) this._track.inert = true;
          this._root.appendChild(this._builder.buildSRList());
          this._root.appendChild(this._track);
          this.#reflow();
        }
        #reflow() {
          const metrics = this._builder.measureCycleMetrics(this._root);
          if (metrics.width === 0) return;
          if (this._anim) this._anim.cancel();
          const reducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
          const baseCycles = Math.ceil(this._root.offsetWidth / (metrics.width + metrics.gap)) + 2;
          const cyclesCount = reducedMotion ? 1 : Math.max(3, baseCycles);
          this._track.innerHTML = '';
          const frag = document.createDocumentFragment();
          for (let i = 0; i < cyclesCount; i++) {
            frag.appendChild(this._builder.buildCycleContainer(!reducedMotion));
          }
          this._track.appendChild(frag);
          if (!reducedMotion) {
            this._anim = new AnimationController(this._track, this._opts);
            this._anim.start(metrics.width, metrics.gap);
          } else {
            const checkOverflow = () => {
              const hasOverflow = this._track.scrollWidth > this._root.offsetWidth;
              this._root.classList.toggle('um-overflow-left', hasOverflow);
              this._root.classList.toggle('um-overflow-right', hasOverflow);
            };
            checkOverflow();
            new ResizeObserver(checkOverflow).observe(this._root);
          }
        }
        #initInteractivity() {
          if (this._opts.pauseOnHover !== false) {
            this._root.addEventListener('mouseenter', () => this._anim?.pause());
            this._root.addEventListener('mouseleave', () => this._anim?.play());
            this._root.addEventListener('focusin', () => this._anim?.pause());
            this._root.addEventListener('focusout', () => this._anim?.play());
          }
          let touchTimer;
          this._root.addEventListener('touchstart', () => {
            this._anim?.pause();
            clearTimeout(touchTimer);
          });
          this._root.addEventListener('touchend', () => {
            clearTimeout(touchTimer);
            touchTimer = setTimeout(() => this._anim?.play(), 600);
          });
        }
        #initObservers() {
          const resizeHandler = () => {
            clearTimeout(this._resizeTimer);
            this._resizeTimer = setTimeout(() => requestAnimationFrame(() => this.#reflow()), 200);
          };
          new ResizeObserver(resizeHandler).observe(this._root);
          if ('IntersectionObserver' in window) {
            this._observer = new IntersectionObserver(
              (entries) => {
                entries.forEach((entry) => {
                  if (!this._anim) return;
                  this._isInViewport = entry.isIntersecting;
                  entry.isIntersecting && !document.hidden ? this._anim.play() : this._anim.pause();
                });
              },
              { rootMargin: '50px 0px' }
            );
            this._observer.observe(this._root);
          }
          document.addEventListener('visibilitychange', () => {
            if (!this._anim) return;
            document.hidden ? this._anim.pause() : this._isInViewport && this._anim.play();
          });
          const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
          mediaQuery.addEventListener('change', () => requestAnimationFrame(() => this.#reflow()));
        }
      }
      window.UniversalMarquee = UniversalMarquee;
    </script>
    <script type="module">
      const createSeparatorSVG = () => {
        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        svg.setAttribute('width', '64');
        svg.setAttribute('fill', 'none');
        svg.setAttribute('viewBox', '0 0 554 264');
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('fill', '#fff');
        path.setAttribute(
          'd',
          'm136.657 5.657-125.5 125.5 126.5 126.5-5.657 5.656L0 131.314l.158-.158L.001 131 131 0l5.657 5.657Zm51 0-125.5 125.5 126.5 126.5-5.657 5.656L51 131.314l.158-.158-.157-.156L182 0l5.657 5.657ZM502.656 131l-.157.156.158.158-132 131.999-5.657-5.656 126.5-126.5L366 5.657 371.657 0l130.999 131Zm51 0-.157.156.158.158-132 131.999-5.657-5.656 126.5-126.5L417 5.657 422.657 0l130.999 131Zm-97.695.327-5.657 5.657-86.271-86.27-.068.068v160.889l.165.165 80.51-80.508 5.657 5.656-82.101 82.1.001.001-4.066 4.065-4.166-4.167v.001l-51-51 5.657-5.656 10.343 10.343v-44.068l-22.534 22.533.002.002-.082.081.033.033-19.005 19.004.002.002-6.367 6.366-26.193-26.192.001-.002-21.826-21.827v44.068l10.343-10.343 5.657 5.656-50.211 50.211.002.002-4.957 4.956-6.371-6.371.001-.002-79.796-79.796 5.657-5.656 80.51 80.508.165-.165V50.782l-.068-.068-86.271 86.27L98 131.327l91.67-91.67 87.31 87.311 87.311-87.31 91.67 91.669Zm-257.965 72.344 22-22v-74.8l9 9v.004l28.191 28.19.001-.001 19.795 19.796 13.047-13.048-13.467-13.467-.001.003-78.566-78.566v144.889Zm85.025-71.945 8.54 8.54v.002l4.503 4.503h.001l.002.001 28.898-28.897v-.004l9-9v74.8l22 22V58.782l-72.944 72.944Z'
        );
        svg.appendChild(path);
        return svg;
      };

      const initApp = () => {
        const DEMO_1_ITEMS = [
          'Seamless infinite horizontal marquee with dynamic cycle duplication (minimum 3 cycles)',
          'Two animation modes: speed-based (px/s) or duration-based (fixed cycle time)',
          "Configurable direction: 'left' or 'right'",
          'Custom gap via --um-gap or gap option (default 2rem)',
          "Custom separator: string, DOM Node, or object {type: 'image', src, alt}",
          'Flexible renderItem callback for rendering arbitrary content',
          "Built-in lazy loading (loading='lazy') with skeleton placeholder",
          'Smooth fade-in transition on image load (.loaded class)',
          'Fixed gallery item dimensions (420×280px default) + border-radius & box-shadow',
          'Gradient overflow masks (.um-overflow-left/right) with custom --bg',
          'Pause on hover/focus (mouseenter, focusin)',
          'Touch interaction: pause on touchstart + delayed resume (600ms)',
          'IntersectionObserver: auto pause/play when entering/leaving viewport',
          'Visibilitychange handler: pause when tab is hidden',
          'Full prefers-reduced-motion compliance → fallback to overflow-x scroll',
          "Accessibility: SR-only <ul> list, aria-label, role='region', aria-hidden & inert on track",
          'ResizeObserver for automatic reflow on container resize',
          'Accurate cycle width measurement via temporary hidden element',
          'Dynamic cycle duplication based on container width',
          'High-performance rendering: Web Animations API, translate3d, will-change: transform',
          'No external dependencies – pure vanilla JS',
          'Fully responsive and mobile-friendly',
          'Highly customizable via CSS variables',
        ];
        new UniversalMarquee('#marquee-demo-1', {
          speed: 60,
          gap: '3rem',
          direction: 'left',
          items: DEMO_1_ITEMS,
          separator: createSeparatorSVG(),
          renderItem: (text) => {
            const span = document.createElement('span');
            span.textContent = text;
            span.style.fontSize = '1.5rem';
            span.style.fontWeight = '800';
            span.style.letterSpacing = '0.5px';
            return span;
          },
          pauseOnHover: true,
          ariaLabel: 'List of Universal Marquee features',
        });
      };

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initApp);
      } else {
        initApp();
      }
    </script>
  </body>
</html>
